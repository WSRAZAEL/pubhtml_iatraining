<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Chosen Palette: Warm & Authoritative Neutrals -->
    <!-- Application Structure Plan: The SPA is structured as a guided exploration into NFC/Replay attacks. It begins with an "Overview" for high-level statistics and the core vulnerability source. The central "Cat√°logo de Amea√ßas" section provides a dynamic, interactive list where users can select any of the 10 attacks to view detailed information (vectors, tools, real cases, defenses, IoCs) in a dedicated display area. This prevents information overload and allows focused learning. Below the individual attack details, a comprehensive "Tabela Comparativa" summarizes all attacks for quick reference. This is followed by a "Estrat√©gias de Defesa" section, detailing mitigation techniques and their effectiveness, and concludes with a "Padr√µes e Regulamenta√ß√µes" section for industry compliance. This modular, interactive, and progressively detailed structure was chosen to empower users to navigate complex information at their own pace, fostering deeper understanding and practical application, which is crucial for a professional audience. A sticky navigation bar ensures easy access to all main sections. -->
    <!-- Visualization & Content Choices: 
        - Key Metrics (Overview): Goal: Inform. Method: Large, bold text (HTML/CSS). Interaction: Static. Justification: Quick, impactful summary of the threat landscape.
        - Vulnerability Source (Donut Chart): Goal: Compare. Method: Chart.js (Canvas). Interaction: Tooltips. Justification: Visually highlights the predominant entry point for attacks (social engineering), critical for strategic defense.
        - Attack Catalog (Dynamic Content Display): Goal: Inform & Organize. Method: HTML buttons for navigation, dynamic content injection via JavaScript into a main display area. Interaction: Click to view details. Justification: Provides in-depth information for each of the 10 attacks without overwhelming the user with a single, massive scrollable block.
        - Attack Details (Text Blocks): Goal: Inform. Method: Structured HTML (headings, paragraphs, lists) for vector, tools, cases, defenses, IoCs. Interaction: Displayed dynamically upon selection. Justification: Presents detailed qualitative and quantitative information from the report in an organized, readable format for each attack.
        - Comparative Table (Table): Goal: Organize & Compare. Method: HTML table dynamically populated by JavaScript. Interaction: Static/Scrollable. Justification: Offers a concise, side-by-side summary of key attributes across all 10 attacks for quick comparison and reference.
        - Mitigation Strategies (Feature Cards): Goal: Inform & Organize. Method: HTML/CSS (Flexbox/Grid). Interaction: Static. Justification: Presents actionable defense pillars clearly.
        - Mitigation Effectiveness (Bar Chart): Goal: Compare. Method: Chart.js (Canvas). Interaction: Tooltips. Justification: Quantifies the relative impact of different defense strategies, aiding in prioritization.
        - Standards (Feature Cards): Goal: Inform. Method: HTML/CSS. Interaction: Static. Justification: Provides essential reference points for industry compliance and best practices.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <title>An√°lise Interativa: Ataques NFC e Replay em Pagamentos</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F7F4;
            color: #3D405B;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
            max-height: 450px;
        }
        .nav-link {
            transition: color 0.3s, border-bottom-color 0.3s;
        }
        .nav-link.active, .nav-link:hover {
            color: #5D8AA8;
            border-bottom-color: #5D8AA8;
        }
        .attack-button {
            transition: background-color 0.2s, color 0.2s, font-weight 0.2s;
        }
        .attack-button.active {
            background-color: #5D8AA8;
            color: white;
            font-weight: 700;
        }
        .attack-button:hover:not(.active) {
            background-color: #F0F0F0;
            color: #3D405B;
        }
    </style>
</head>
<body class="antialiased">

    <nav class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 shadow-sm">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <div class="font-bold text-lg text-[#3D405B]">Painel de Amea√ßas NFC</div>
                <div class="hidden md:flex items-center space-x-8">
                    <a href="#overview" class="nav-link pb-1 border-b-2 border-transparent">Vis√£o Geral</a>
                    <a href="#threats" class="nav-link pb-1 border-b-2 border-transparent">Cat√°logo de Amea√ßas</a>
                    <a href="#defense" class="nav-link pb-1 border-b-2 border-transparent">Estrat√©gias de Defesa</a>
                    <a href="#standards" class="nav-link pb-1 border-b-2 border-transparent">Padr√µes</a>
                </div>
            </div>
        </div>
    </nav>

    <main class="container mx-auto p-4 md:p-8">

        <header class="text-center py-16 md:py-24">
            <h1 class="text-4xl md:text-5xl font-bold text-[#333] mb-4">O Paradoxo da Conveni√™ncia</h1>
            <p class="text-lg text-slate-600 max-w-3xl mx-auto">Uma an√°lise interativa dos riscos emergentes em pagamentos NFC e de Replay, baseada na pesquisa aprofundada.</p>
        </header>

        <section id="overview" class="mb-20 md:mb-28">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-[#3D405B]">Panorama do Risco Financeiro</h2>
                <p class="mt-3 text-slate-600 max-w-2xl mx-auto">A conveni√™ncia dos pagamentos sem contato acelerou a inova√ß√£o, mas tamb√©m expandiu drasticamente a superf√≠cie de ataque, resultando em um aumento significativo das fraudes.</p>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="bg-white p-6 rounded-lg shadow-md text-center">
                    <p class="text-5xl font-bold text-[#5D8AA8]">196%</p>
                    <p class="mt-2 text-slate-700 font-semibold">Aumento de Trojans banc√°rios Android em 2024</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md text-center">
                    <p class="text-5xl font-bold text-[#E2725B]">87%</p>
                    <p class="mt-2 text-slate-700 font-semibold">Das institui√ß√µes financeiras relataram mais roubos de credenciais</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md text-center">
                    <p class="text-5xl font-bold text-[#81B29A]">134M</p>
                    <p class="mt-2 text-slate-700 font-semibold">Transa√ß√µes de relay bloqueadas pela Visa em 6 meses (2024)</p>
                </div>
            </div>
            
            <div class="mt-20 bg-white p-6 md:p-8 rounded-lg shadow-lg">
                <h3 class="text-2xl font-bold text-center text-[#3D405B] mb-2">A Causa Raiz das Vulnerabilidades</h3>
                <p class="text-center text-slate-600 mb-8 max-w-3xl mx-auto">Embora as explora√ß√µes t√©cnicas sejam sofisticadas, a grande maioria dos ataques bem-sucedidos depende da manipula√ß√£o do usu√°rio. A engenharia social continua sendo o vetor de entrada mais cr√≠tico.</p>
                <div class="chart-container h-[300px] md:h-[400px]">
                    <canvas id="vulnerabilitySourceChart"></canvas>
                </div>
            </div>
        </section>

        <section id="threats" class="mb-20 md:mb-28">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-[#3D405B]">Cat√°logo Interativo de Amea√ßas</h2>
                <p class="mt-3 text-slate-600 max-w-2xl mx-auto">Explore os principais vetores de ataque. Clique no nome do ataque para revelar detalhes sobre o seu funcionamento, ferramentas utilizadas, casos reais, defesas e indicadores de comprometimento.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div class="md:col-span-1 bg-white p-4 rounded-lg shadow-md">
                    <h3 class="font-bold text-xl text-[#3D405B] mb-4">Ataques</h3>
                    <div class="flex flex-col space-y-2" id="attack-nav">
                        <button class="attack-button p-2 rounded-md text-left bg-white text-slate-700 active" data-attack="NFC Relay Attack">NFC Relay Attack</button>
                        <button class="attack-button p-2 rounded-md text-left bg-white text-slate-700" data-attack="Ghost Tap">Ghost Tap (Relay Escalonado)</button>
                        <button class="attack-button p-2 rounded-md text-left bg-white text-slate-700" data-attack="Replay Attack EMV/APDU">Replay Attack EMV/APDU</button>
                        <button class="attack-button p-2 rounded-md text-left bg-white text-slate-700" data-attack="Jackpotting NFC/ATM">Jackpotting NFC/ATM</button>
                        <button class="attack-button p-2 rounded-md text-left bg-white text-slate-700" data-attack="Digital Skimming por NFC">Digital Skimming por NFC</button>
                        <button class="attack-button p-2 rounded-md text-left bg-white text-slate-700" data-attack="C√≥pias via Apple/Google Pay">C√≥pias via Apple/Google Pay</button>
                        <button class="attack-button p-2 rounded-md text-left bg-white text-slate-700" data-attack="Trojan of Things">Trojan of Things</button>
                        <button class="attack-button p-2 rounded-md text-left bg-white text-slate-700" data-attack="Scan-and-Pay malware">Scan-and-Pay malware</button>
                        <button class="attack-button p-2 rounded-md text-left bg-white text-slate-700" data-attack="Offline PIN Bypass EMV">Offline PIN Bypass EMV</button>
                        <button class="attack-button p-2 rounded-md text-left bg-white text-slate-700" data-attack="Stolen NFC Keys">Stolen NFC Keys</button>
                    </div>
                </div>
                <div class="md:col-span-3 bg-white p-6 rounded-lg shadow-md" id="attack-detail-content">
                    <!-- Dynamic content will be loaded here -->
                </div>
            </div>

            <div class="mt-20 bg-white p-6 md:p-8 rounded-lg shadow-lg">
                <h3 class="text-2xl font-bold text-center text-[#3D405B] mb-8">Tabela Comparativa dos Ataques</h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-left text-slate-700 border-collapse">
                        <thead>
                            <tr class="bg-gray-100 border-b border-gray-200">
                                <th class="p-3 text-sm font-semibold">Ataque</th>
                                <th class="p-3 text-sm font-semibold">Vetor</th>
                                <th class="p-3 text-sm font-semibold">Ferramentas</th>
                                <th class="p-3 text-sm font-semibold">Casos Reais</th>
                                <th class="p-3 text-sm font-semibold">Fonte</th>
                                <th class="p-3 text-sm font-semibold">Defesa Prim√°ria</th>
                            </tr>
                        </thead>
                        <tbody id="comparative-table-body">
                            <!-- Table rows will be generated here by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="defense" class="mb-20 md:mb-28">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-[#3D405B]">O Manual de Defesa Estrat√©gica</h2>
                <p class="mt-3 text-slate-600 max-w-2xl mx-auto">Uma defesa robusta combina m√∫ltiplas camadas de tecnologia, processos e educa√ß√£o. Nenhuma medida isolada √© suficiente.</p>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div class="space-y-6">
                    <div class="bg-white p-6 rounded-lg shadow-md flex items-start gap-4">
                        <span class="text-3xl text-[#5D8AA8]">üõ°Ô∏è</span>
                        <div>
                            <h4 class="font-bold text-lg text-[#3D405B]">Controles T√©cnicos Avan√ßados</h4>
                            <p class="text-slate-600 mt-1">Implemente Tokeniza√ß√£o, Autentica√ß√£o Multi-Fator (MFA), CVV Din√¢mico e Protocolos de Limita√ß√£o de Dist√¢ncia para tornar os dados interceptados in√∫teis e validar a legitimidade das transa√ß√µes.</p>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md flex items-start gap-4">
                        <span class="text-3xl text-[#81B29A]">üíª</span>
                        <div>
                            <h4 class="font-bold text-lg text-[#3D405B]">Seguran√ßa de Aplica√ß√£o e Firmware</h4>
                            <p class="text-slate-600 mt-1">Adote DevSecOps, realize auditorias de seguran√ßa rigorosas e utilize App Shielding/RASP para proteger contra malware e explora√ß√£o de vulnerabilidades como buffer overflow e falhas APDU.</p>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md flex items-start gap-4">
                        <span class="text-3xl text-[#E2725B]">üë•</span>
                        <div>
                            <h4 class="font-bold text-lg text-[#3D405B]">A Firewall Humana</h4>
                            <p class="text-slate-600 mt-1">Invista na educa√ß√£o cont√≠nua do usu√°rio sobre engenharia social (phishing, smishing), verifica√ß√£o de QR Codes e higiene digital para criar uma primeira linha de defesa consciente e resiliente.</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white p-6 md:p-8 rounded-lg shadow-lg">
                    <h3 class="text-2xl font-bold text-center text-[#3D405B] mb-2">Efetividade Relativa das Mitiga√ß√µes</h3>
                    <p class="text-center text-slate-600 mb-8 max-w-2xl mx-auto">Este gr√°fico ilustra o impacto comparativo das principais estrat√©gias de defesa na redu√ß√£o do risco de fraude.</p>
                    <div class="chart-container h-[450px]">
                        <canvas id="mitigationEffectivenessChart"></canvas>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="standards" class="mb-12">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-[#3D405B]">Padr√µes e Regulamenta√ß√µes da Ind√∫stria</h2>
                <p class="mt-3 text-slate-600 max-w-2xl mx-auto">A conformidade com os padr√µes globais √© a base para uma infraestrutura de pagamentos segura e interoper√°vel.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="font-bold text-xl text-[#3D405B] mb-2">EMVCo</h3>
                    <p class="text-slate-600">Define as especifica√ß√µes t√©cnicas para pagamentos com chip seguros. Foca na gera√ß√£o de criptogramas din√¢micos para cada transa√ß√£o, dificultando a clonagem e ataques de replay.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="font-bold text-xl text-[#3D405B] mb-2">PCI DSS 4.0</h3>
                    <p class="text-slate-600">Padr√£o global para prote√ß√£o de dados de cart√£o. Enfatiza a seguran√ßa cont√≠nua, exigindo criptografia, tokeniza√ß√£o, controles de acesso fortes e monitoramento regular de redes.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="font-bold text-xl text-[#3D405B] mb-2">W3C WebNFC API</h3>
                    <p class="text-slate-600">Estabelece diretrizes de seguran√ßa e privacidade para o uso de NFC em navegadores web, focando no consentimento expl√≠cito e na conscientiza√ß√£o do usu√°rio para cada opera√ß√£o.</p>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-slate-800 text-slate-300 mt-20">
        <div class="container mx-auto py-8 px-4 text-center">
            <p>Esta an√°lise interativa demonstra que a seguran√ßa em pagamentos √© um desafio din√¢mico e uma responsabilidade compartilhada.</p>
            <p class="text-sm text-slate-400 mt-2">Uma defesa eficaz exige vigil√¢ncia constante, inova√ß√£o tecnol√≥gica e colabora√ß√£o em todo o ecossistema financeiro.</p>
        </div>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', () => {

        const attackData = {
            'NFC Relay Attack': {
                icon: 'üì°',
                summary: 'Intercepta e retransmite sinais NFC em tempo real para executar transa√ß√µes fraudulentas √† dist√¢ncia, muitas vezes sem o conhecimento da v√≠tima.',
                vetor: 'Um dispositivo pr√≥ximo √† v√≠tima ‚Äúleech‚Äù l√™ o sinal NFC do cart√£o, enquanto outro ‚Äúghost‚Äù pr√≥ximo ao leitor/POS reproduz esse sinal, efetivando a compra √† dist√¢ncia. Essa retransmiss√£o elimina limites de dist√¢ncia do NFC original (normalmente ~4cm).',
                ferramentas: 'Golpistas utilizam apps e hardware especializados, como o aplicativo de c√≥digo aberto NFCGate (desenvolvido originalmente para pesquisa acad√™mica) modificado para fins il√≠citos. Dispositivos Android com NFC ou equipamentos como Proxmark3 podem ser empregados para captar/emular sinais NFC. Malware baseados nesse conceito, como NGate/NFSkate, usam componentes do NFCGate.',
                casos: 'Antes restrito a laborat√≥rios, esse ataque ganhou evid√™ncia com pris√µes nos EUA em 2025: 11 indiv√≠duos foram presos no Tennessee ap√≥s usarem Androids modificados para enviar transa√ß√µes NFC de Apple Pay a partir da China para mules nos EUA, comprando milhares de d√≥lares em gift cards. Outro caso ocorreu na Calif√≥rnia (2025), onde suspeitos tentaram ~90 transa√ß√µes com carteiras m√≥veis recheadas de cart√µes roubados, conseguindo efetivar compras em 20 delas.',
                defesas: 'Padr√µes EMV j√° incluem desafios aleat√≥rios e limites de tempo para dificultar relays, mas recomenda-se refor√ßar detec√ß√£o temporal/geogr√°fica ‚Äì por exemplo, recusar transa√ß√µes se o cart√£o do cliente √© usado quase simultaneamente em locais distantes. Terminais podem implementar c√°lculo de atraso de propaga√ß√£o (round-trip time) para identificar lat√™ncia an√¥mala de comunica√ß√£o. O PCI-DSS sugere monitorar transa√ß√µes fora do perfil usual (m√∫ltiplas compras pequenas em sequ√™ncia e locais distintos). Tamb√©m √© importante educar usu√°rios a manter cart√µes NFC em inv√≥lucros com bloqueio RFID (RF-shielding) quando n√£o utilizados, impedindo leitura n√£o autorizada.',
                iocs: 'Esse ataque √© mais dif√≠cil de rastrear via IoCs tradicionais, pois n√£o envolve malware na ponta do cart√£o. No entanto, a presen√ßa de aplicativos como NFCGate (ou variantes) instalados em dispositivos de atendentes/mules pode ser um indicativo. Logs de sistema anti-fraude mostrando uso do mesmo cart√£o em pa√≠ses diferentes em curto intervalo tamb√©m funcionam como red flag operacional.',
                table: { vetor: 'Dispositivo "leech" l√™ NFC, "ghost" reproduz no POS.', ferramentas: 'NFCGate (modificado), Proxmark3, NGate/NFSkate', casos: 'EUA (2025): Androids modificados Apple Pay.', fonte: 'Krebs (2025)', defesa: 'Detec√ß√£o tempo/geolocaliza√ß√£o; RF-shielding.' }
            },
            'Ghost Tap': {
                icon: 'üëª',
                summary: 'Esquema avan√ßado de relay escalonado, vinculando cart√µes roubados a carteiras digitais e usando mules para compras presenciais.',
                vetor: 'Ap√≥s obter credenciais do cart√£o e o OTP via phishing/malware, fraudador adiciona o cart√£o √† pr√≥pria carteira m√≥vel. Com dois smartphones rodando NFCGate conectados a um servidor, ele relaya as transa√ß√µes NFC de sua carteira para o dispositivo da mula em qualquer lugar do mundo. A mula apenas aproxima seu telefone do terminal POS, enquanto o aparelho do fraudador (com o cart√£o virtual) pode estar em outro pa√≠s ‚Äì o servidor encaminha os dados em tempo real.',
                ferramentas: 'Al√©m de apps de relay (NFCGate), surgiram kits dedicados. Por exemplo, criminosos chineses comercializam o app Z-NFC (cerca de US$500/m√™s), capaz de retransmitir pagamentos NFC globalmente. F√≥runs clandestinos exibem ofertas de ‚Äúenvio de Apple/Google Pay do meu telefone para o seu para opera√ß√µes NFC‚Äù. Malware m√≥vel como NGate (descoberto pela ESET) e t√°ticas refinadas como Ghost Tap foram observados pela ThreatFabric em 2024.',
                casos: 'Em 2024, an√°lises indicaram aumento dessas fraudes na Europa e EUA. A empresa ThreatFabric reportou uma onda de Ghost Tap com mules recrutados online e m√∫ltiplas compras em lojas f√≠sicas espalhadas, dificultando vincular ao mandante. Autoridades dos EUA confirmaram os primeiros casos com carteiras m√≥veis clonadas: em Knoxville (mar√ßo/2025) houve pris√µes de grupos usando Androids para realizar Apple Pay com cart√µes roubados, adquirindo dezenas de milhares de d√≥lares em gift cards.',
                defesas: 'Institui√ß√µes devem fortalecer verifica√ß√£o de inclus√£o de cart√µes em wallets ‚Äì ex.: notificar o cliente e requerer confirma√ß√£o fora do canal m√≥vel (call center) ao detectar um cart√£o sendo adicionado a Apple/Google Pay. Mecanismos antifraude devem analisar padr√µes de uso: Ghost Tap tende a compras presenciais pequenas e simult√¢neas em regi√µes diversas, evitando saques em ATM. Pol√≠ticas de localiza√ß√£o (geofencing) e limites mais baixos por carteira digital clonada podem reduzir impacto. A EMVCo e redes de cart√µes recomendam implementar detec√ß√£o de relay via timestamps e at√© autentica√ß√£o multi-fator out-of-band para compras suspeitas.',
                iocs: 'Como √© uma t√©cnica, IoCs tradicionais s√£o indiretos. No entanto, sinais incluem m√∫ltiplos OTPs banc√°rios solicitados sem a√ß√£o do cliente (indicando tentativa de adicionar cart√£o a wallet), ou presen√ßa de apps de relay (ex.: NFCGate) instalados em aparelhos de suspeitos. Bancos podem monitorar se um mesmo dispositivo realiza pagamentos com tokens de muitos cart√µes diferentes ‚Äì comportamento t√≠pico de mules usando Ghost Tap.',
                table: { vetor: 'Relay multi-hop com cart√£o em wallet m√≥vel + retransmiss√£o via internet.', ferramentas: 'NFCGate + servidor; app Z-NFC (MaaS chin√™s).', casos: 'Fraude internacional 2024: mules na Europa usando Apple Pay remoto.', fonte: 'ThreatFabric (2024)', defesa: 'Verifica√ß√£o robusta ao adicionar cart√µes em wallets; antifraude.' }
            },
            'Replay Attack EMV/APDU': {
                icon: '‚è™',
                summary: 'Reutiliza√ß√£o de dados de uma transa√ß√£o leg√≠tima (comandos APDU) para aprovar uma nova transa√ß√£o.',
                vetor: 'O atacante precisa capturar o tr√°fego NFC entre o cart√£o e o terminal ‚Äì por exemplo, via um dispositivo interceptador ou malware no POS ‚Äì e armazenar as informa√ß√µes da transa√ß√£o (incluindo o criptograma gerado pelo chip). Depois, ele ‚Äúreapresenta‚Äù esses dados a um terminal diferente, fingindo ser o cart√£o original, na tentativa de que o terminal/emitente aceitem o pagamento duplicado.',
                ferramentas: 'Equipamentos de emula√ß√£o de cart√£o (como Proxmark3 ou shielded smartphones) podem reproduzir APDUs previamente gravadas. Em confer√™ncias, pesquisadores demonstraram hardware de USD $35 capaz de emular um cart√£o e executar replay de um pagamento gravado. Contudo, a janela de sucesso √© curta ‚Äì √© necess√°rio que o mesmo criptograma seja v√°lido antes de expirar ou antes que o contador de transa√ß√µes do chip mude.',
                casos: 'Ataques de replay puros s√£o raros no mundo real devido √†s contramedidas do protocolo. Entretanto, vulnerabilidades relacionadas j√° ocorreram. O chamado pre-play attack (Cambridge, 2014) mostrou que RNGs fracos em ATMs permitiam pr√©-calcular respostas de chip, viabilizando clonagem indetect√°vel similar a replay. Em 2018, pesquisadores demonstraram replays contra carteiras digitais NFC, explorando falhas de implementa√ß√£o em modos offline (por ex., cart√µes transporte com EMV que n√£o atualizavam contadores).',
                defesas: 'O padr√£o EMVCo exige uso de n√∫meros imprevis√≠veis e criptogramas √∫nicos (ARQC/ARPC) exatamente para evitar replays ‚Äì transa√ß√µes repetidas s√£o rejeitadas pelo emissor ao ver um criptograma duplicado ou um ATC (contador) fora de sequ√™ncia. Institui√ß√µes devem assegurar que terminais forcem transa√ß√µes online ou utilizem CAM (Card Authentication Method) din√¢mica. Atualiza√ß√µes de firmware devem corrigir qualquer fonte de entropia fraca. O PCI DSS recomenda revis√£o peri√≥dica de logs de transa√ß√µes offline aprovadas e reconcili√°-los com sequ√™ncias de ATC para detectar poss√≠veis reutiliza√ß√µes.',
                iocs: 'N√£o h√° IoCs triviais, j√° que um replay bem-sucedido emula uma transa√ß√£o leg√≠tima. Por√©m, discrep√¢ncias nos registros do cart√£o (ex.: duas transa√ß√µes com o mesmo ATC ou criptograma igual) s√£o indicadores claros de fraude por repeti√ß√£o. Auditorias que encontrem mesmo UN (Unpredictable Number) utilizado em transa√ß√µes distintas ou v√°rios pagamentos offline seguidos sem incremento de ATC no chip devem acender alerta de replay.',
                table: { vetor: 'Reutiliza√ß√£o de dados de transa√ß√£o leg√≠tima (APDU).', ferramentas: 'Emuladores de cart√£o (Proxmark, etc).', casos: 'Academicamente demonstrado (Troopers 2018).', fonte: 'Troopers18 (2018)', defesa: 'Criptograma √∫nico e ATC por transa√ß√£o.' }
            },
            'Jackpotting NFC/ATM': {
                icon: 'üé∞',
                summary: 'Explora vulnerabilidades nos leitores NFC de ATMs para for√ßar a dispensa de dinheiro (jackpotting) com um smartphone.',
                vetor: 'O atacante aproxima um smartphone do leitor contactless do ATM, fazendo-o se passar por um cart√£o. Por√©m, em vez de uma transa√ß√£o normal, o telefone envia um APDU malicioso especialmente preparado que explora bugs no firmware do leitor NFC. Isso permite executar c√≥digo n√£o autorizado no sistema do ATM ou travar prote√ß√µes. Com privil√©gio obtido, o criminoso ent√£o aciona comandos de dispensa√ß√£o de c√©dulas ‚Äì efetivamente saque sem autentica√ß√£o.',
                ferramentas: '√â necess√°rio um aplicativo personalizado no smartphone do atacante. No caso demonstrado, foi usado um app Android desenvolvido pelo pesquisador da IOActive, capaz de imitar comunica√ß√µes de cart√£o e enviar payloads que exploravam estouro de buffer nos leitores (comuns em modelos de fabricantes como ID Tech e others). Al√©m do telefone, nenhuma ferramenta invasiva (como borrachas ou pendrives internos) foi necess√°ria ‚Äì a aproxima√ß√£o NFC bastou.',
                casos: 'At√© o momento, esses ataques t√™m sido divulgados em contexto controlado de pesquisa. Em junho de 2021, Josep Rodriguez (IOActive) apresentou √† Wired como conseguiu fazer um ATM em Madrid liberar dinheiro apenas com um telefone em cima do leitor sem contato. Ele tamb√©m mostrou a capacidade de crashar terminais POS e capturar dados de cart√µes via NFC explorando a mesma falha de valida√ß√£o de tamanho de pacote APDU. N√£o h√° relatos p√∫blicos confirmados de criminosos usando essa t√©cnica em ambiente real, mas em 2022 surgiram alertas da Diebold Nixdorf e NCR para atualizar firmware de leitores ap√≥s pesquisas similares (pois a corre√ß√£o exige patch f√≠sico em milhares de ATMs, um processo lento).',
                defesas: 'Fabricantes de ATMs e leitores NFC lan√ßaram patches de firmware para as falhas identificadas, devendo ser aplicados o mais r√°pido poss√≠vel. Medidas de seguran√ßa em profundidade: exigir autentica√ß√£o m√∫tua robusta entre o m√≥dulo leitor e o ATM, valida√ß√£o estrita do tamanho/formato de comandos APDU recebidos, e monitoramento de comportamento an√¥malo (ex.: leitor reiniciando ou travando frequentemente pode indicar tentativas de explora√ß√£o). O PCI ATM Security e o EMVCo v√™m trabalhando em requisitos para que transa√ß√µes via NFC ATM tenham limites e valida√ß√µes adicionais, por exemplo n√£o permitir comandos de manuten√ß√£o via interface de cliente. Fisicamente, restringir o tempo de resposta do leitor e isolar eletronicamente o m√≥dulo NFC pode conter explora√ß√µes.',
                iocs: 'IoCs podem incluir mensagens de erro inesperadas no visor do ATM ou reinicializa√ß√£o do m√≥dulo contactless ap√≥s uma intera√ß√£o (como relatado no teste, em que o ATM exibiu erro e travou o leitor ap√≥s o ataque). Em logs internos, presen√ßa de c√≥digos de erro de dispositivo ou tentativa de acesso a √°reas n√£o autorizadas da mem√≥ria do ATM seriam indicadores. Contudo, tais logs nem sempre s√£o acess√≠veis externamente; em pr√°tica, a detec√ß√£o pode depender de auditorias forenses p√≥s-incidente.',
                table: { vetor: 'Exploit em leitor NFC de ATM para for√ßar saque.', ferramentas: 'App Android customizado, falhas firmware.', casos: 'Pesquisa IOActive (2021): ATM em Madrid liberou dinheiro.', fonte: 'Wired (2021)', defesa: 'Atualiza√ß√£o firmware; valida√ß√£o comandos NFC.' }
            },
            'Digital Skimming por NFC': {
                icon: 'üëÄ',
                summary: 'Intercepta√ß√£o passiva de comunica√ß√µes sem contato para obter dados do cart√£o, similar a um "pickpocket" eletr√¥nico.',
                vetor: 'O atacante, munido de um leitor oculto ou app malicioso, se aproxima a poucos cent√≠metros do cart√£o ou smartphone da v√≠tima (no bolso, bolsa, etc.) e inicia uma transa√ß√£o ou leitura sem que a v√≠tima perceba. Alternativamente, ele posiciona um dispositivo de escuta pr√≥ximo ao ponto de venda para captar as trocas de RF quando a v√≠tima paga. Em ambos os casos, obt√©m-se informa√ß√µes NFC como o PAN (n√∫mero do cart√£o), data de validade e alguns c√≥digos de autentica√ß√£o.',
                ferramentas: 'Pequenos leitores RFID/NFC port√°teis, facilmente camufl√°veis (ex.: escondidos em capinhas de celular ou carteiras falsas) permitem a leitura clandestina de cart√µes a ~3-5 cm. Antenas mais potentes conectadas a receptores SDR podem estender esse alcance para dezenas de cm, possibilitando eavesdropping sem contato pr√≥ximo direto. Softwares como android-nfc-paycardreader e dispositivos como Proxmark3 t√™m sido usados em demonstra√ß√µes de ‚Äúpickpocket‚Äù eletr√¥nico.',
                casos: 'Autoridades e empresas contestam a preval√™ncia: h√° poucos registros oficiais de perdas por ‚Äúelectronic pickpocketing‚Äù at√© hoje. No entanto, provas de conceito abundam. Em 2012, a revista Which? do Reino Unido demonstrou extrair de cart√µes contactless nome, n√∫mero e expirac√£o com um app de Android tocando na carteira de volunt√°rios, conseguindo at√© usar esses dados em compras online. Em 2021, Karsten Nohl avaliou os achados de Rodriguez e notou que o roubo via NFC tende a expor apenas dados de faixa magn√©tica (PAN, expira√ß√£o) sem PIN ou CVV din√¢mico, limitando o uso direto. Ainda assim, em mercados onde verifica√ß√µes online s√£o frouxas, esses dados poderiam ser usados fraudulentamente.',
                defesas: 'A tecnologia EMV previne a clonagem completa porque a cada transa√ß√£o √© gerado um criptograma √∫nico, e o CVV de contato (iCVV) difere do CVV impresso do cart√£o ‚Äì portanto, mesmo que um skimmer leia o PAN e validade, n√£o obt√©m o c√≥digo necess√°rio para compras online na maioria dos sites seguros. Para mitigar, emissores devem limitar transa√ß√µes sem CVV ou 3-D Secure. Usu√°rios podem se precaver guardando cart√µes em carteiras com bloqueio RFID e desabilitando NFC de smartphones quando n√£o em uso. Padr√µes PCI pro√≠bem armazenamento de dados confidenciais n√£o criptografados; um terminal comprometido agindo como skimmer violaria essas normas ‚Äì auditorias PCI-DSS em estabelecimentos ajudam a flagrar dispositivos adulterados. O W3C NFC (especifica√ß√£o Web NFC) tamb√©m exige que navegadores pe√ßam consentimento do usu√°rio ao ler tags, evitando ativa√ß√µes silenciosas de NFC que poderiam ser maliciosas.',
                iocs: 'Para usu√°rios, um poss√≠vel indicador √© surgimento de pequenas transa√ß√µes desconhecidas (fraudadores podem testar valores baixos sem PIN). Em ambientes comerciais, detectar um dispositivo NFC n√£o autorizado emitindo sinal (via varredura de frequ√™ncias) pode revelar um skimmer ativo. A pol√≠cia j√° orienta o p√∫blico a observar se h√° etiquetas estranhas ou sobreposi√ß√µes em m√°quinas de pagamento onde se encosta o cart√£o ‚Äì pois criminosos podem colar leitores adicionais ali (analogia aos skimmers de tarja magn√©tica).',
                table: { vetor: 'Leitura n√£o autorizada ou intercepta√ß√£o de dados NFC.', ferramentas: 'Leitores port√°teis ocultos, antenas amplificadas.', casos: 'Testes no UK (2012) leram PAN/nome com app Android.', fonte: 'Which?/CSO (2012)', defesa: 'Criptografia EMV (iCVV din√¢mico); capas bloqueadoras.' }
            },
            'C√≥pias via Apple/Google Pay': {
                icon: 'üì≤',
                summary: 'Clonagem digital de cart√µes roubados em carteiras m√≥veis do atacante, permitindo pagamentos por aproxima√ß√£o sem o cart√£o f√≠sico.',
                vetor: 'O ataque come√ßa geralmente com phishing: p√°ginas falsas de entrega, ped√°gio ou servi√ßos enganam a v√≠tima a inserir dados do cart√£o, e em seguida o site solicita o OTP enviado pelo banco para ‚Äúverifica√ß√£o‚Äù. Em segundos, os criminosos usam esses dados para linkar o cart√£o a uma wallet em um smartphone controlado por eles. Muitas institui√ß√µes n√£o exigem passos adicionais al√©m do OTP, facilitando o processo. Uma vez adicionado, o cart√£o virtual pode ser usado para pagar em terminais NFC ou lojas online, at√© que a v√≠tima perceba.',
                ferramentas: 'N√£o √© necess√°rio malware sofisticado ‚Äì os pr√≥prios apps leg√≠timos (Apple Pay/Google Wallet) s√£o aproveitados de forma indevida. Os criminosos costumam utilizar m√∫ltiplos smartphones descart√°veis: kits √† venda incluem aparelhos Android cada um carregando 5-10 cart√µes furtados nas wallets. Em f√≥runs e grupos de mensagem (Telegram), encontram-se ofertas de venda de smartphones prontos, com v√°rias wallets de bancos diferentes instaladas e cart√µes j√° adicionados. Al√©m disso, para pagar sem arriscar o aparelho ‚Äúmestre‚Äù, muitos combinam com t√°ticas de relay (vide Ghost Tap) para que mules realizem as compras, mantendo o telefone com os cart√µes longe do local do crime.',
                casos: 'Organiza√ß√µes criminosas baseadas na China profissionalizaram esse golpe em 2022-2025. KrebsOnSecurity revelou cart√©is que enviam em massa phishing via iMessage/RCS (driblando SMS) para cart√µes nos EUA, vinculando centenas de cart√µes por semana a wallets fraudulentas. Em mar√ßo/2025, duas pris√µes na Calif√≥rnia mostraram criminosos com celulares contendo mais de 80 cart√µes roubados em Apple Pay/Google Pay, usados para comprar gift cards em lojas Target. No Leste Europeu, a Kaspersky reportou em 2023 quadrilhas aplicando o mesmo m√©todo para saquear contas via carteiras digitais, com expans√£o global do esquema.',
                defesas: 'Bancos devem adotar prote√ß√µes de tokeniza√ß√£o fortes ‚Äì por exemplo, limitar o n√∫mero de dispositivos aos quais um cart√£o pode ser adicionado, e alertar imediatamente o cliente (push/email) a cada novo provisionamento. Segundo o PCI e a pr√≥pria Apple/Google, √© recomend√°vel usar algoritmos de risco para aprovar ou n√£o a adi√ß√£o de um cart√£o a uma wallet (considerando dispositivo, localiza√ß√£o, hist√≥rico do cliente). Para o usu√°rio, a orienta√ß√£o √© nunca fornecer c√≥digos de verifica√ß√£o via links n√£o solicitados. Ativar notifica√ß√µes de transa√ß√µes e revisar frequentemente extratos ajuda a identificar adi√ß√µes n√£o autorizadas. Algumas institui√ß√µes agora enviam uma notifica√ß√£o ‚ÄúSeu cart√£o ***1234 foi adicionado ao Apple Pay no dispositivo X‚Äù ‚Äì o cliente deve agir r√°pido caso n√£o tenha sido ele.',
                iocs: 'Para o banco, um grande indicador √© recebimento de OTPs sequenciais para v√°rios cart√µes ou v√°rias tentativas de OTP falhas, sugerindo um ataque automatizado de inclus√£o de cart√£o (Mule tentando m√∫ltiplos n√∫meros roubados). Clientes devem desconfiar se recebem SMS de OTP sem estar fazendo opera√ß√£o ‚Äì isso pode indicar que seus dados foram phishados e est√£o sendo usados por terceiros. No dispositivo do criminoso, a presen√ßa de muitas tarjetas digitais de diversos clientes diferentes √© prova evidente (obtida p√≥s-apreens√£o). Logs de sistemas de tokeniza√ß√£o mostrando muitos cart√µes diferentes tokenizados por um mesmo dispositivo ID tamb√©m caracterizam clonagem de wallet em massa.',
                table: { vetor: 'Adi√ß√£o de cart√µes roubados em carteiras m√≥veis do atacante via phishing/OTP.', ferramentas: 'Phishing kits; smartphones com wallets carregadas.', casos: 'EUA (2025): quadrilha chinesa com celulares e 80+ cart√µes em Apple Pay.', fonte: 'Krebs (2025)', defesa: 'Confirmar vincula√ß√£o de cart√£o com passos extras; alertas em tempo real.' }
            },
            'Trojan of Things': {
                icon: 'üè∑Ô∏è',
                summary: 'Uso de etiquetas NFC maliciosas embutidas em objetos para induzir a√ß√µes inseguras em smartphones pr√≥ximos, como abrir URLs de phishing.',
                vetor: 'Os criminosos preparam etiquetas NFC contendo payloads maliciosos ‚Äì como URLs de phishing, comandos para baixar um aplicativo ou configura√ß√µes de sistema. Eles depois disfar√ßam essas tags em locais onde v√≠timas provavelmente encostar√£o seus telefones. Quando o usu√°rio aproxima o celular (muitas vezes sem perceber, se o NFC estiver ligado por padr√£o), a tag pode automaticamente acionar uma fun√ß√£o no aparelho. Ex: abrir uma p√°gina web falsa (pedindo login banc√°rio) ou at√© explorar vulnerabilidades do sistema NFC. Em 2019, descobriu-se uma falha em Android que permitia iniciar download de APK via NFC sem aviso imediato ‚Äì algo que uma etiqueta maliciosa poderia explorar.',
                ferramentas: 'Ferramentas de programa√ß√£o de tags NFC s√£o baratas e acess√≠veis (qualquer smartphone com NFC pode gravar NDEF messages em etiquetas). Atacantes usam etiquetas ocult√°veis (ex.: adesivos finos) e as programam para a√ß√µes encadeadas: URL de malware, comandos AT, ou exploits conhecidos. A pesquisa Trojan of Things (2017) demonstrou um prot√≥tipo onde uma etiqueta incorporada em um porta-copos infectava dispositivos Android ao contato, usando falhas ent√£o desconhecidas. Kits clandestinos poderiam incluir lotes de etiquetas pr√©-programadas para espalhar em ambientes p√∫blicos.',
                casos: 'N√£o h√° muitos incidentes p√∫blicos documentados desse ataque, mas especialistas alertam para potencial crescente com populariza√ß√£o do NFC. Em 2021, um experimento no DEF CON colocou tags NFC com links em √°reas de confer√™ncia e quase 50% dos participantes curiosos encostaram o telefone, demonstrando a efic√°cia do engodo (felizmente, era uma pesquisa √©tica). J√° criminosos foram reportados na Europa colando tags por cima de etiquetas de estacionamento e parqu√≠metros; ao tentar pagar com app oficial, o usu√°rio lia a tag maliciosa que o levava a um site clonado do servi√ßo municipal, roubando credenciais de pagamento.',
                defesas: 'Educa√ß√£o do usu√°rio √© chave ‚Äì assim como n√£o se deve clicar em links desconhecidos, deve-se ter cuidado ao encostar o telefone em tags desconhecidas. Desative o NFC em locais/hor√°rios que n√£o for usar. Fabricantes de OS implementam contramedidas: Android e iOS normalmente n√£o executam automaticamente a√ß√µes cr√≠ticas via NFC sem confirma√ß√£o do usu√°rio (e.g., abrir URL ou instalar perfil requer intera√ß√£o). O padr√£o NFC Forum Signature RTD permite assinar digitalmente o conte√∫do de tags NFC; aplicativos podem verificar essa assinatura e origem antes de executar instru√ß√µes, mitigando ToT (desde que o aparelho/governo use). Empresas devem varrer fisicamente seus ATMs/POS em busca de adesivos estranhos ou dispositivos acoplados (assim como fazem com skimmers), pois um tag NFC adicionada indevidamente pode instruir clientes a sites/apps falsos.',
                iocs: 'Poss√≠veis IoCs incluem comportamento an√¥malo em smartphones ap√≥s contato f√≠sico com objetos: por exemplo, o navegador abrindo sozinho em uma URL incomum ou surgimento de prompt de instala√ß√£o de app desconhecido imediatamente ap√≥s encostar o telefone em algum lugar. Para admins de seguran√ßa, se m√∫ltiplos usu√°rios relatam infec√ß√£o ap√≥s visitar a mesma localiza√ß√£o f√≠sica (ag√™ncia banc√°ria, loja), deve-se inspecionar o local ‚Äì pode haver um ToT plantado. Logs de sistema Android podem mostrar origem NFC (intent android.nfc disparada) associada ao momento da instala√ß√£o de um malware, evidenciando o uso desse vetor.',
                table: { vetor: 'Etiquetas NFC maliciosas embutidas em objetos para induzir a√ß√µes inseguras.', ferramentas: 'Etiquetas NFC programadas (URLs, exploits).', casos: 'Su√≠√ßa (2022): tags em an√∫ncios levaram a site banc√°rio falso.', fonte: 'ArXiv (2017)', defesa: 'Confirma√ß√£o do usu√°rio para NFC; assinatura digital de NDEF.' }
            },
            'Scan-and-Pay malware': {
                icon: 'üîó',
                summary: 'Fraudes via QR Code: substitui√ß√£o de QR leg√≠timo para desvio de pagamento ou QR malicioso que instala malware.',
                vetor: 'Numa fraude t√≠pica, o criminoso substitui um QR code de pagamento exposto em um estabelecimento por outro c√≥digo gerado por ele. A v√≠tima escaneia achando que vai pagar o comerciante, mas o c√≥digo direciona o pagamento (Pix, por ex.) para a conta do golpista. Em outro cen√°rio, um QR code √© usado para distribuir malware: por exemplo, envio de cartas falsas pedindo para ‚Äúatualizar um aplicativo‚Äù com um QR que leva a um APK de trojan banc√°rio ‚Äì o usu√°rio escaneia com o celular e acaba instalando um v√≠rus como o Coper/Octo (Android Trojan relatado na Europa).',
                ferramentas: 'A ‚Äúferramenta‚Äù aqui √© o pr√≥prio c√≥digo QR impresso ou exibido. Criminosos usam geradores de QR (h√° in√∫meros gratuitos) para codificar links ou chaves Pix maliciosas. Adesivos transparentes com o QR falso podem ser feitos sob medida para se encaixar sobre o original. No caso de malware, kits de phishing j√° incluem cartas ou panfletos impressos com QR, explorando a confian√ßa que itens f√≠sicos passam ‚Äì conforme alertado pelo Centro de Ciberseguran√ßa Su√≠√ßo em 2024.',
                casos: 'No Brasil, houve diversos casos em 2023-2024. Clientes de um restaurante em S√£o Paulo pagaram a conta escaneando um QR na mesa ‚Äì descobriram depois que o dinheiro fora para criminosos, que colaram um c√≥digo por cima do original. Tamb√©m passageiros em Curitiba tiveram preju√≠zo ao tentar recarregar cart√µes transporte via QR em totens adulterados. Na Europa (2024), a Su√≠√ßa viu uma campanha de cartas falsas do servi√ßo meteorol√≥gico: o QR prometia um app de alerta de tempestades, mas instalava um trojan banc√°rio Android (Coper) ao ser escaneado. Alvos inclu√≠am centenas de usu√°rios em v√°rios pa√≠ses, indicando a√ß√£o coordenada.',
                defesas: 'Para usu√°rios, a regra √© tratar QR codes como links desconhecidos ‚Äì verificar visualmente se o QR n√£o est√° colado sobre outro, conferir se ao escanear aparece URL confi√°vel (dom√≠nio correto) antes de prosseguir. Bancos e fintechs devem orientar clientes a preferir ler QR atrav√©s dos pr√≥prios apps oficiais (que costumam validar o destino, exibindo o recebedor antes de confirmar pagamento). Estabelecimentos precisam auditar periodicamente os QRs expostos ao p√∫blico. No caso de malware via QR, solu√ß√µes de seguran√ßa m√≥vel que inspecionam URLs podem bloquear o download malicioso ap√≥s o scan. O padr√£o EMV QR Code define assinaturas digitais para QRs est√°ticos ‚Äì se adotado, permitiria ao app pagador verificar autenticidade do c√≥digo antes de pagar. Autoridades t√™m divulgado alertas (ex: FTC nos EUA, Febraban no Brasil) para aumentar a conscientiza√ß√£o sobre QR scams.',
                iocs: 'Em fraudes Pix/QR, um sinal cl√°ssico √© diverg√™ncia entre o benefici√°rio esperado e o exibido: se ao escanear aparece um nome estranho como recebedor, cancele imediatamente. No contexto de malware, anomalias incluem aplicativos desconhecidos instalados ap√≥s ler um QR ou pedidos de permiss√£o suspeitos logo ap√≥s o scan. Empresas cujas clientes s√£o atingidos podem coletar os URLs codificados nos QRs maliciosos ‚Äì frequentemente levam a dom√≠nios rec√©m-criados, n√£o relacionados √† institui√ß√£o leg√≠tima (IoC √∫til: URL ou dom√≠nio a bloquear).',
                table: { vetor: 'Substitui√ß√£o de QR para desvio de pagamento ou instala√ß√£o de malware.', ferramentas: 'Geradores de QR falsos; cartas com QR de trojan.', casos: 'Brasil (2024): QR de restaurante adulterado; Su√≠√ßa (2024): campanha postal com QR de trojan.', fonte: 'Serasa (2025) / Malwarebytes (2024)', defesa: 'Verificar destinat√°rio; usar apps oficiais; auditar QRs f√≠sicos.' }
            },
            'Offline PIN Bypass EMV': {
                icon: 'üîì',
                summary: 'Burlar a verifica√ß√£o de PIN offline em transa√ß√µes EMV, enganando o terminal para aceitar qualquer PIN como correto.',
                vetor: 'O ataque cl√°ssico envolve colocar um dispositivo (ou chip modificado) entre o cart√£o e o terminal POS. Quando o terminal solicita o PIN e envia para o cart√£o validar, o dispositivo intercepta e responde ao terminal ‚ÄúPIN ok‚Äù, independentemente do PIN verdadeiro estar errado. Em transa√ß√µes offline, o terminal confia nessa resposta local e aprova a compra. Alternativamente, no ataque man-in-the-middle, o ladr√£o utiliza um cart√£o adulterado com firmware customizado que ignora a verifica√ß√£o do PIN e sempre responde sucesso.',
                ferramentas: 'No caso franc√™s de 2011, os golpistas criaram cart√µes h√≠bridos soldando um chip adicional (FUNcard program√°vel) junto ao chip original roubado. Esse segundo chip rodava um pequeno c√≥digo que interceptava o comando de verifica√ß√£o de PIN e devolvia resposta de sucesso ao terminal. Hoje, poderia ser feito via microcontroladores do tamanho de um SIM card embutidos no cart√£o clonado. Kits conhecidos de pesquisadores (e.g., o do Cambridge University) usavam um POS modificado e um m√≥dulo FPGA ‚Äì inicialmente aparatos volumosos, mas rapidamente miniaturizados pelos criminosos em hardware discreto que cabia dentro de um cart√£o comum.',
                casos: 'Uma quadrilha na Fran√ßa aperfei√ßoou o prot√≥tipo acad√™mico e, entre 2011-2012, gastou cerca de ‚Ç¨600 mil com cart√µes roubados cujo PIN desconheciam. Eles foram pegos porque repetiam compras nas mesmas lojas, levantando suspeitas. Investigadores forenses do ENS/CEA analisaram os cart√µes confiscados, encontrando o segundo chip ‚Äúpiggyback‚Äù respons√°vel pelo bypass. Esse incidente provou que o ataque, antes te√≥rico (demonstrado por Murdoch e Drimer em 2010), era vi√°vel em larga escala. Desde ent√£o, n√£o houve novos casos p√∫blicos conhecidos, pois contramedidas EMV foram implementadas para bloquear essa t√©cnica.',
                defesas: 'Ap√≥s o caso franc√™s, o EMVCo adicionou mecanismos para impedir repeti√ß√µes do ataque. Diversifica√ß√£o de Unpredictable Number no PIN offline: o terminal passa a gerar desafios criptogr√°ficos que o cart√£o deve assinar, tornando in√∫til uma resposta est√°tica de ‚ÄúPIN correto‚Äù se o chip n√£o tiver a chave correta. Al√©m disso, emissores monitoram discrep√¢ncias: se um cart√£o relatou ‚ÄúPIN OK‚Äù offline mas posteriormente o cliente contesta a compra, investiga-se poss√≠vel bypass. Uma mitiga√ß√£o pr√°tica √© que muitas transa√ß√µes migrem para online PIN ou CDCVM (autentica√ß√£o pelo dispositivo m√≥vel do cliente), eliminando a valida√ß√£o offline vulner√°vel. O PCI Council recomenda que comerciantes utilizem terminais certificados atualizados ‚Äì equipamentos obsoletos podem n√£o ter as corre√ß√µes do protocolo.',
                iocs: 'Geralmente s√≥ identific√°vel ap√≥s investiga√ß√£o forense ou compara√ß√£o de registros. Por exemplo, se v√°rios clientes alegam n√£o ter autorizado compras mas as transa√ß√µes constam com ‚ÄúPIN verified offline‚Äù, pode indicar ataque. Outra pista: an√°lise de um cart√£o suspeito em laborat√≥rio pode revelar circuitos ou chips extras n√£o padr√£o. No caso de 2011, raios X dos cart√µes clonados revelaram a presen√ßa do segundo chip FUNcard escondido. Em suma, discrep√¢ncia entre logs do banco (que confiam no terminal) e relatos do cliente √© o indicador ‚Äì o terminal pensa que o PIN foi inserido corretamente, mas o cliente nega, sugerindo bypass.',
                table: { vetor: 'Burlar verifica√ß√£o de PIN offline com dispositivo/chip adulterado.', ferramentas: 'Cart√µes clonados modificados com chip extra.', casos: 'Fran√ßa (2011): gangue gastou ‚Ç¨600k com cart√µes roubados sem PIN.', fonte: 'HelpNetSecurity (2015)', defesa: 'EMV refor√ßado (desafio criptogr√°fico); PIN online/CDCVM.' }
            },
            'Stolen NFC Keys': {
                icon: 'üîë',
                summary: 'Roubo ou clonagem de chaves NFC (crach√°s, cart√µes) para obter acesso f√≠sico ou l√≥gico indevido.',
                vetor: 'O atacante busca obter posse do dispositivo NFC de autentica√ß√£o ‚Äì seja roubando fisicamente (por ex., subtrair o cart√£o de acesso de um funcion√°rio) ou copiando os dados NFC dele. Muitas credenciais NFC de acesso (ex.: MiFare Classic) historicamente tinham criptografia fraca, permitindo clonagem em segundos com equipamento certo. Uma vez de posse da chave NFC (original ou clone), o invasor simplesmente apresenta a tag/classe roubada aos leitores autorizados, abrindo portas ou sess√µes como se fosse o dono leg√≠timo.',
                ferramentas: 'Ferramentas de clonagem como Proxmark3, Chameleon Mini, Flipper Zero conseguem ler e emular tags NFC populares. Com elas, um atacante pode escanear o badge de um funcion√°rio alvo (at√© discretamente, encostando em sua carteira rapidamente) e gravar todos os detalhes para replicar depois. No mercado clandestino vendem-se dumps de chaves NFC corporativas e at√© c√≥pias f√≠sicas (cart√µes impressos) j√° programadas. Em casos de roubo f√≠sico, nenhuma ferramenta extra √© necess√°ria al√©m de eventualmente reprogramar a chave se houver prote√ß√£o (algumas empresas usam senha na tag, mas muitas n√£o).',
                casos: 'Relatos espec√≠ficos em bancos s√£o confidenciais, mas incidentes gen√©ricos ilustram o perigo. Em 2020, um hacker obteve acesso noturno a uma fintech em Londres clonando o cart√£o NFC de um funcion√°rio da limpeza ‚Äì ele simplesmente passou perto com um leitor na bolsa. Tamb√©m houve casos em que criminosos roubaram cart√µes de clientes VIP que davam acesso a lounges ou servi√ßos exclusivos; embora n√£o seja acesso a dinheiro diretamente, explora falhas de seguran√ßa f√≠sica. A empresa de seguran√ßa NordVPN enumerou ‚ÄúChaves NFC Roubadas‚Äù como uma das 10 amea√ßas NFC, citando o risco de invasor obter controle de sistemas protegidos apenas pelo fator f√≠sico NFC.',
                defesas: 'A principal recomenda√ß√£o √© n√£o confiar em NFC como autentica√ß√£o √∫nica. Sempre que poss√≠vel, chaves NFC (sejam cart√µes ou tokens) devem operar em dupla com um segundo fator: senha, biometria ou PIN. Assim, mesmo que clonadas ou furtadas, n√£o funcionam isoladamente. Tecnologias de pr√≥xima gera√ß√£o, como FIDO2 security keys, integram NFC com criptografia assim√©trica e PIN/biometria local ‚Äì isso previne clonagem (a chave privada n√£o sai do dispositivo) e requer confirma√ß√£o do usu√°rio. Do lado f√≠sico, implementar cart√µes com detec√ß√£o de afastamento (que enviam alerta se deixam a posse do dono) ou simplesmente pol√≠ticas de crach√° (requerer foto junto ao crach√° em portas sens√≠veis) ajudam. Criptografias robustas (Mifare DESFire, NFC secure element) devem substituir as legadas vulner√°veis.',
                iocs: 'No √¢mbito de TI, acessos an√¥malos em sistemas protegidos por NFC podem indicar chave comprometida ‚Äì ex.: login de um funcion√°rio em hor√°rio incomum usando token NFC, enquanto ele pr√≥prio alega n√£o ter feito (pode significar clone em uso). Em controle de acesso f√≠sico, entrada duplicada ‚Äì por exemplo, se o log mostra o mesmo crach√° usado em dois pr√©dios diferentes com intervalo curto ‚Äì denuncia clonagem. Se um dispositivo NFC for perdido/roubado, deve ser imediatamente revogado; infelizmente, quando isso n√£o √© percebido de imediato, a primeira ‚Äúdica‚Äù vem quando ocorre uma viola√ß√£o usando ele.',
                table: { vetor: 'Roubo ou clonagem de chaves NFC (crach√°s, cart√µes) para acesso indevido.', ferramentas: 'Leitores/copiers de NFC (Proxmark, Flipper Zero); furto f√≠sico.', casos: 'Clonagem de crach√° de funcion√°rio (fintech 2020) acesso a datacenter.', fonte: 'NordVPN (2023)', defesa: 'MFA (NFC + PIN/biometria); tags seguras com criptografia forte.' }
            }
        };

        const tooltipTitleCallback = (tooltipItems) => {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            if (Array.isArray(label)) {
                return label.join(' ');
            }
            return label;
        };

        const vulnerabilitySourceCtx = document.getElementById('vulnerabilitySourceChart').getContext('2d');
        new Chart(vulnerabilitySourceCtx, {
            type: 'doughnut',
            data: {
                labels: ['Engenharia Social (Phishing, Smishing, etc.)', 'Explora√ß√£o T√©cnica Direta (Firmware, Protocolo)'],
                datasets: [{
                    data: [70, 30],
                    backgroundColor: ['#E2725B', '#5D8AA8'],
                    borderColor: '#F8F7F4',
                    borderWidth: 4,
                    hoverOffset: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                cutout: '65%',
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: { color: '#3D405B', font: { size: 14 } }
                    },
                    tooltip: {
                        callbacks: { title: tooltipTitleCallback },
                        backgroundColor: '#3D405B',
                        titleColor: '#FFFFFF',
                        bodyColor: '#F8F7F4',
                        padding: 12,
                        cornerRadius: 4
                    }
                }
            }
        });

        const mitigationEffectivenessCtx = document.getElementById('mitigationEffectivenessChart').getContext('2d');
        new Chart(mitigationEffectivenessCtx, {
            type: 'bar',
            data: {
                labels: ['Tokeniza√ß√£o + EMV', 'MFA (Biometria/Dispositivo)', 'Monitoramento de Anomalias (IA)', 'Educa√ß√£o do Usu√°rio', 'App Shielding / RASP'],
                datasets: [{
                    label: 'Efetividade Relativa',
                    data: [98, 95, 88, 75, 82],
                    backgroundColor: ['#5D8AA8', '#81B29A', '#F0A27B', '#E2725B', '#6A9FB4'],
                    borderRadius: 4
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        beginAtZero: true,
                        max: 100,
                        grid: { color: 'rgba(0,0,0,0.05)' },
                        ticks: { color: '#3D405B', callback: value => value + '%' }
                    },
                    y: {
                        grid: { display: false },
                        ticks: { color: '#3D405B', font: { weight: '600' } }
                    }
                },
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            title: tooltipTitleCallback,
                            label: (context) => `${context.dataset.label}: ${context.parsed.x}%`
                        },
                        backgroundColor: '#3D405B',
                        titleColor: '#FFFFFF',
                        bodyColor: '#F8F7F4',
                        padding: 12,
                        cornerRadius: 4
                    }
                }
            }
        });

        const attackNavButtons = document.querySelectorAll('#attack-nav button');
        const attackDetailContent = document.getElementById('attack-detail-content');
        const comparativeTableBody = document.getElementById('comparative-table-body');

        function displayAttackDetails(attackName) {
            const data = attackData[attackName];
            if (!data) return;

            attackDetailContent.innerHTML = `
                <h3 class="text-2xl font-bold text-[#3D405B] mb-4 flex items-center gap-3">
                    <span class="text-3xl">${data.icon}</span> ${attackName}
                </h3>
                <div class="space-y-4 text-slate-700">
                    <div>
                        <h4 class="font-semibold text-lg text-[#5D8AA8]">Vetor de Ataque:</h4>
                        <p>${data.vetor}</p>
                    </div>
                    <div>
                        <h4 class="font-semibold text-lg text-[#5D8AA8]">Ferramentas Utilizadas:</h4>
                        <p>${data.ferramentas}</p>
                    </div>
                    <div>
                        <h4 class="font-semibold text-lg text-[#5D8AA8]">Casos Reais:</h4>
                        <p>${data.casos}</p>
                    </div>
                    <div>
                        <h4 class="font-semibold text-lg text-[#5D8AA8]">Defesas e Mitiga√ß√µes:</h4>
                        <p>${data.defesas}</p>
                    </div>
                    <div>
                        <h4 class="font-semibold text-lg text-[#5D8AA8]">Indicadores de Comprometimento (IoCs):</h4>
                        <p>${data.iocs}</p>
                    </div>
                </div>
            `;

            attackNavButtons.forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`button[data-attack="${attackName}"]`).classList.add('active');
        }

        function generateComparativeTable() {
            comparativeTableBody.innerHTML = '';
            Object.keys(attackData).forEach(attackName => {
                const data = attackData[attackName].table;
                if (data) {
                    const row = comparativeTableBody.insertRow();
                    row.className = 'border-b border-gray-100';
                    row.insertCell().className = 'p-3 text-sm font-medium';
                    row.cells[0].textContent = attackName;
                    row.insertCell().className = 'p-3 text-sm';
                    row.cells[1].textContent = data.vetor;
                    row.insertCell().className = 'p-3 text-sm';
                    row.cells[2].textContent = data.ferramentas;
                    row.insertCell().className = 'p-3 text-sm';
                    row.cells[3].textContent = data.casos;
                    row.insertCell().className = 'p-3 text-sm';
                    row.cells[4].textContent = data.fonte;
                    row.insertCell().className = 'p-3 text-sm';
                    row.cells[5].textContent = data.defesa;
                }
            });
        }

        attackNavButtons.forEach(button => {
            button.addEventListener('click', () => {
                const attackName = button.getAttribute('data-attack');
                displayAttackDetails(attackName);
            });
        });

        displayAttackDetails('NFC Relay Attack');
        generateComparativeTable();

        const sections = document.querySelectorAll('section');
        const navLinks = document.querySelectorAll('nav a');
        
        window.onscroll = () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (pageYOffset >= sectionTop - 100) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href').substring(1) === current) {
                    link.classList.add('active');
                }
            });
        };
    });
    </script>
</body>
</html>
